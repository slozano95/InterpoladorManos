import numpy as np
from scipy.interpolate import splprep, splev, interp1d
import matplotlib.pyplot as plt

#mano prueba
#pts = np.array([(4.3,0),(4.3,0.8),(4.1,1.4),(3.8,2.1),(3.6,2.6),(3,3.1),(2.6,3.5),(2.3,3.8),(2.3,4.3),(2.7,4.4),(3.2,4),(3.8,3.9),(4.2,3.7),(4.5,3.7),(4.5,4.3),(4.5,5.3),(4.5,6.4),(5,6.4),(5.2,5.4),(5.3,4.4),(5.5,3.8),(5.9,3.8),(6.2,4.8),(6.5,6),(6.5,6.8),(6.8,7.9),(7.3,7.8),(7.3,6.7),(7.3,5.7),(7.2,4.6),(7.3,3.6),(8,3.4),(8.3,4.2),(8.6,5.2),(9,5.9),(9.5,5.8),(9.4,5),(9.1,4.1),(9,3.2),(9.5,2.9),(9.9,3.3),(10.5,3.9),(11,3.9),(11.1,3.5),(10.6,3),(10.1,2.4),(9.7,2),(9.5,1.6),(9.3,1),(9.1,0.5),(9,0)])
#mano ocampo
#pts = np.array([(10,1),(9,3),(8.5,5),(8,8),(7.5,10),(7,12),(6.5,15),(6.5,19),(5,23),(4,25),(3,29),(3,31),(4,32),(5,31),(6,29),(7,25),(9,22),(10,19),(11,19),(12,20),(12,24),(11.5,27),(11.5,30),(11.2,33),(11.3,35),(11.5,38),(12,40),(13,40),(14.2,39),(14.5,36),(14.6,33),(14.5,31),(15,28),(15.5,25),(15.8,22),(16.4,22),(16.8,25),(16.8,27),(16.8,29),(17,31),(17.5,33),(17.3,35),(17.5,38),(17.5,40),(18,41),(19,41.4),(20,41),(21,39),(21,35),(20.7,32),(21,29),(20.5,24),(21,22),(22,22),(22.5,25),(23,28),(23.5,29.5),(24,31),(24.5,34),(25,37),(26,38.5),(27,38.3),(28,37),(28,34),(27.5,31),(27.2,28),(27,26),(26,22),(25.8,20),(26,16),(26.2,14),(27,13),(28,12.8),(29.3,14),(31,17),(33,20),(34,21.3),(35,22),(36,22.2),(37,21),(36,19),(35,17),(34,15),(32,12),(31,11),(29,8),(27,4.5),(26,3),(24,1)])
##mano lopez completo
#pts = np.array([(14,-1),(13.8,0),(13.4,1),(13,2),(12.6,3),(12,4),(11.7,5),(11.4,6),(11,7),(10.9,8),(10.7,9),(10.4,10),(10.3,11),(10,12),(9.8,13),(9.7,14),(9.5,15),(9.3,16),(9.3,17),(9.3,18),(9.2,19),(9,20),(8.6,21),(8.5,22),(8.4,23),(8,24),(7.9,25),(7.5,26),(7.5,27),(7.3,28),(7.2,29),(7.1,30),(8,31),(8.5,31.3),(10,30),(10.2,29),(10.4,28),(10.6,27),(10.8,26),(11,25),(11.2,24),(11.6,23),(12,22),(12.3,21),(13,20.3),(13.1,21),(13.1,22),(13.1,23),(13.1,24),(13,25),(13,26),(13,27),(13,28),(13,29),(13,30),(13,31),(13,32),(13,33),(13,34),(13,35),(13.1,36),(13.2,37),(13.5,38),(14,38.4),(14.5,38.5),(15,38.3),(15.4,38),(15.5,37),(15.6,36),(15.6,35),(15.6,34),(15.6,33),(15.5,32),(15.5,31),(15.5,30),(15.8,29),(16.1,28),(16.4,27),(16.4,26),(16.4,25),(16.2,24),(16.4,23.2),(16.6,24),(16.7,25),(16.8,26),(17,27),(16.9,28),(16.9,29),(17,30),(17,31),(17.1,32),(17.1,33),(17.2,34),(17.3,35),(17.5,36),(17.5,37),(17.6,38),(17.6,39),(17.7,40),(18.1,41),(18.6,41.3),(20,41.2),(21.1,40),(21.1,39),(21,38),(21,37),(21,36),(21,35),(20.7,34),(20.7,33),(20.7,32),(21,31),(21,30),(21,29),(20.7,28),(20.6,27),(20.5,26),(20.5,25),(20.4,24),(20.5,23.6),(21,24.1),(21,25),(21.2,26),(21.3,27),(21.4,28),(21.5,29),(21.6,30),(22,31),(22,32),(22.1,33),(22.3,34),(22.4,35),(22.6,38),(23,37.8),(23.3,39),(24,39.3),(25,39),(25.6,38),(25.8,37),(25.7,36),(25.6,35),(25.6,33),(25.5,32),(25.5,31),(25.6,30),(25.5,29),(25.4,28.4),(25.2,27),(25.1,26),(25,25),(24.6,24),(24.7,23),(25,22),(25,21),(25,20),(25.1,19),(25.2,18),(25.4,17),(26.4,16.3),(27,16.6),(27.4,17),(28,18),(28.4,19),(29,20),(29.2,21),(29.9,22),(30.5,23),(31,23.4),(31.6,24),(32.5,24.2),(34,24.8),(35,24.5),(35.7,24),(35.8,23),(35.4,22),(34.7,21),(34.2,20),(33.6,19),(33,18),(32.5,17),(31.7,16),(31.2,15),(30.7,14),(30.5,13),(30.2,12),(30,11),(29.3,10),(29,9),(28.5,8),(28.2,7),(27.7,6),(27.3,5),(27,4),(26.8,3),(26.5,2.3),(26,1.5),(25.2,0),(25,-1)])

#mano lopez de a dos
#pts = np.array([(14.0,-1.0),(13.4,1.0),(12.6,3.0),(11.7,5.0),(11.0,7.0),(10.7,9.0),(10.3,11.0),(9.8,13.0),(9.5,15.0),(9.3,17.0),(9.2,19.0),(8.6,21.0),(8.4,23.0),(7.9,25.0),(7.5,27.0),(7.2,29.0),(8.0,31.0),(10.0,30.0),(10.4,28.0),(10.8,26.0),(11.2,24.0),(12.0,22.0),(13.0,20.3),(13.1,22.0),(13.1,24.0),(13.0,26.0),(13.0,28.0),(13.0,30.0),(13.0,32.0),(13.0,34.0),(13.1,36.0),(13.5,38.0),(14.5,38.5),(15.4,38.0),(15.6,36.0),(15.6,34.0),(15.5,32.0),(15.5,30.0),(16.1,28.0),(16.4,26.0),(16.2,24.0),(16.6,24.0),(16.8,26.0),(16.9,28.0),(17.0,30.0),(17.1,32.0),(17.2,34.0),(17.5,36.0),(17.6,38.0),(17.7,40.0),(18.6,41.3),(21.1,40.0),(21.0,38.0),(21.0,36.0),(20.7,34.0),(20.7,32.0),(21.0,30.0),(20.7,28.0),(20.5,26.0),(20.4,24.0),(21.0,24.1),(21.2,26.0),(21.4,28.0),(21.6,30.0),(22.0,32.0),(22.3,34.0),(22.6,38.0),(23.3,39.0),(25.0,39.0),(25.8,37.0),(25.6,35.0),(25.5,32.0),(25.6,30.0),(25.4,28.4),(25.1,26.0),(24.6,24.0),(25.0,22.0),(25.0,20.0),(25.2,18.0),(26.4,16.3),(27.4,17.0),(28.4,19.0),(29.2,21.0),(30.5,23.0),(31.6,24.0),(34.0,24.8),(35.7,24.0),(35.4,22.0),(34.2,20.0),(33.0,18.0),(31.7,16.0),(30.7,14.0),(30.2,12.0),(29.3,10.0),(28.5,8.0),(27.7,6.0),(27.0,4.0),(26.5,2.3),(25.2,0.0)])

#mano lina
pts = np.array([(7,5),(6.2,7),(6.1,10),(6.6,17),(6.9,18),(6.9,20),(6,23),(5,25),(4,28),(2.8,32),(2.4,34),(3,35.6),(4,35.8),(4.5,36),(6.2,33),(7.2,30),(8.8,26),(11,22.4),(12,24),(11.4,30),(11.6,33),(11.4,35),(11.1,41),(12,42.4),(14,42),(15,39),(15,33),(15.6,28),(16.2,24.2),(16.4,25),(16.8,28),(16.8,32),(17.6,36),(18,40),(19,43.8),(21,43.4),(22,40),(21.6,35),(21.4,31),(21.8,27),(21,23.4),(22.2,24),(23.6,28),(24.2,30),(25.8,34),(27.2,38),(28,38.8),(30.1,38),(30,34),(28.4,30),(27.4,26),(25.6,22),(25.2,18),(25,16),(27,12.4),(30.4,13.8),(31,15),(35.1,17.8),(37,17.2),(37.4,16),(34.7,13),(32.9,11),(30.2,9),(29.2,8),(28.2,7),(27,6),(25.8,5),(24.6,4),(23.2,3),(22,2)])
#CON SPLINE


print len(pts)

#SPLPREP: DADA UNA LISTA DE PUNTOS HAYAR UNA CURVA SUAVISADA QUE PASE POR TODOS LOS PUNTOS
puntos, espacio = splprep(pts.T, u=None, s=0.0, per=1)

#LINSPACE: RETORNA UN ESPACIO LINEAL DADOS LOS LIMITES SEPARADOS IGUALMENTE
espacio_nuevo = np.linspace(espacio.min(), espacio.max(), 1500)

#SPLEV: EVALUA LAS DERIVADAS EN LAS CURVAS DADOS LOS PUNTOS Y SUS COEFICIENTES
x2, y2 = splev(espacio_nuevo, puntos, der=0)

#CARGAR PUNTOS EN X Y EN Y, UTILIZANDO COLOR AMARILLO y ESTRELLAS PARA LOS PUNTOS
plt.plot(pts[:,0], pts[:,1], 'b*')

#CARGAR LOS SPLINES UTILIZANDO ROJO Y CON RAYA FIJA
plt.plot(x2, y2, 'b-')

#MSOTRAR LA GRAFICA
plt.show()

